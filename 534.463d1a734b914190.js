"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[534],{534:(w,A,a)=>{a.r(A),a.d(A,{AdminPageModule:()=>F});var h=a(6814),m=a(95),s=a(6728),Z=a(6958),d=a(5861),T=a(5196),C=a(1789),v=a(1702),e=a(6242),_=a(408),b=a(3722);function P(o,u){if(1&o&&(e.TgZ(0,"ion-col",25)(1,"ion-item")(2,"ion-label",1)(3,"h2"),e._uU(4,"Estado:"),e.qZA(),e.TgZ(5,"ion-text"),e._uU(6),e.qZA()()(),e.TgZ(7,"ion-item")(8,"ion-label",1)(9,"h2"),e._uU(10,"Deuda Restante:"),e.qZA(),e.TgZ(11,"ion-text"),e._uU(12),e.qZA()()(),e.TgZ(13,"ion-item")(14,"ion-label",1)(15,"h2"),e._uU(16,"Cuotas Restantes:"),e.qZA(),e.TgZ(17,"ion-text"),e._uU(18),e.qZA()()()()),2&o){const c=u.$implicit;e.xp6(6),e.hij(" ",c._state.toString(),""),e.xp6(6),e.hij(" ",c._deudaRestante.toString(),""),e.xp6(6),e.Oqu(c._cuotasRestantes.toString())}}function S(o,u){if(1&o&&(e.TgZ(0,"ion-row")(1,"ion-header",23)(2,"ion-title",1),e._uU(3),e.qZA()(),e.YNc(4,P,19,3,"ion-col",24),e.qZA()),2&o){const c=u.$implicit;e.xp6(3),e.hij("User: ",c.key,""),e.xp6(1),e.Q6J("ngForOf",c.value)}}const y=[{path:"",component:(()=>{var o;class u{constructor(t,n,i,r){this.document=t,this.authService=n,this.txService=i,this.formBuilder=r,this.prestamosCursando={},this.admin=n.OWNER,this.web3=new T.ZPm,this.web3.setProvider(new this.web3.providers.HttpProvider(this.authService.PROVIDER)),this.window=t.defaultView,this.definirForm=r.group({porcentajeInteres:"10",cantidad:"1000",cuotas:"3",penalizacionImpago:"10"}),this.invertirForm=r.group({amount:""}),this.recogerForm=r.group({amount:""}),this.factoryContract=new this.web3.eth.Contract(C.d.abi,n.FACTORY)}ngOnInit(){var t=this;return(0,d.Z)(function*(){localStorage.getItem("userAddress")!==t.authService.OWNER&&(t.window.location.href="/home"),t.balance=yield t.factoryContract.methods.getBalance().call({from:localStorage.getItem("userAddress")}),t.clientes=yield t.factoryContract.methods.getClientes().call({from:localStorage.getItem("userAddress")}),yield t.iniciarVistaContratados()})()}invertir(t){var n=this.factoryContract.methods.invertir().encodeABI();console.log(t.amount);var i=this.web3.utils.toHex(parseInt(t.amount));this.txService.makeTransaction(this.authService.FACTORY,i,n)}recogerFondos(t){var n=this.factoryContract.methods.recolectarFondos(t.amount).encodeABI();this.txService.makeTransaction(this.authService.FACTORY,0,n)}iniciarVistaContratados(){var t=this;return(0,d.Z)(function*(){t.clientes.forEach(function(){var n=(0,d.Z)(function*(i){var r=yield t.factoryContract.methods.verContratos(i).call({from:localStorage.getItem("userAddress")}),l=[];r.forEach(function(){var p=(0,d.Z)(function*(f){var I=yield new t.web3.eth.Contract(v.d.abi,f),g=yield I.methods.mostrarInfo().call({from:localStorage.getItem("userAddress")});g._ultimoCheckeo=t.secondsToDateString(g._ultimoCheckeo),g._state=t.contratoStateToString(g._state),l.push(g),console.log(l)});return function(f){return p.apply(this,arguments)}}()),t.prestamosCursando[i]=l});return function(i){return n.apply(this,arguments)}}())})()}checkeoMensual(){var t=this;return(0,d.Z)(function*(){t.clientes.forEach(function(){var n=(0,d.Z)(function*(i){t.prestamosCursando[i].forEach(function(){var r=(0,d.Z)(function*(l){var f=(yield new t.web3.eth.Contract(v.d.abi,l._direccion)).methods.checkeoMensual().encodeABI();t.txService.makeTransaction(l._direccion,0,f)});return function(l){return r.apply(this,arguments)}}())});return function(i){return n.apply(this,arguments)}}())})()}definirPrestamo(t){var n=this.factoryContract.methods.definirPrestamo(t.porcentajeInteres,t.cantidad,t.cuotas,t.penalizacionImpago).encodeABI();this.txService.makeTransaction(this.authService.FACTORY,0,n)}secondsToDateString(t){var n=t.toString(),i=1e3*Number(n),r=new Date(i);return r.setMonth(r.getMonth()+1),r.getDay()+"/"+(r.getMonth()+1)+"/"+r.getFullYear()}contratoStateToString(t){return 0==t?"CUOTA PAGADA":1==t?"PLAZO ABIERTO":"FINALIZADO"}logOut(){window.location.href="/home"}}return(o=u).\u0275fac=function(t){return new(t||o)(e.Y36(h.K0),e.Y36(_.u),e.Y36(b.l),e.Y36(m.qu))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-admin"]],decls:67,vars:10,consts:[[3,"translucent"],[1,"ion-text-center"],[1,"ion-text-center",3,"fullscreen"],[1,"ion-text-center","ion-margin"],["size","4"],[1,"ion-padding-bottom"],[1,"ion-margin",3,"formGroup","ngSubmit"],["position","floating"],["formControlName","porcentajeInteres"],["formControlName","cantidad"],["formControlName","cuotas"],["formControlName","penalizacionImpago"],["expand","block","type","submit"],["size","8"],[1,"scrollable-content"],[4,"ngFor","ngForOf"],[1,"ion-margin","ion-align-items-center","ion-justify-content-center"],[1,"ion-align-items-center"],["size","6"],["formControlName","amount"],[1,"ion-margin"],["expand","block",1,"ion-margin",3,"click"],["expand","block",3,"click"],[1,"ion-margin","ion-padding","ion-align-items-center"],["size","3.1",4,"ngFor","ngForOf"],["size","3.1"]],template:function(t,n){1&t&&(e.TgZ(0,"ion-header",0)(1,"ion-toolbar",1)(2,"ion-title"),e._uU(3),e.qZA()()(),e.TgZ(4,"ion-content",2)(5,"ion-row",3)(6,"ion-col",4)(7,"ion-header",5)(8,"ion-title",1),e._uU(9,"Define un nuevo pr\xe9stamo"),e.qZA()(),e.TgZ(10,"form",6),e.NdJ("ngSubmit",function(){return n.definirPrestamo(n.definirForm.value)}),e.TgZ(11,"ion-item")(12,"ion-label",7),e._uU(13,"Porcentaje Interes"),e.qZA(),e._UZ(14,"ion-input",8),e.qZA(),e.TgZ(15,"ion-item")(16,"ion-label",7),e._uU(17,"Cantidad Prestada"),e.qZA(),e._UZ(18,"ion-input",9),e.qZA(),e.TgZ(19,"ion-item")(20,"ion-label",7),e._uU(21,"Numero cuotas"),e.qZA(),e._UZ(22,"ion-input",10),e.qZA(),e.TgZ(23,"ion-item")(24,"ion-label",7),e._uU(25,"Penalizacion Impago"),e.qZA(),e._UZ(26,"ion-input",11),e.qZA(),e.TgZ(27,"ion-button",12),e._uU(28,"Definir"),e.qZA()()(),e.TgZ(29,"ion-col",13)(30,"ion-header",5)(31,"ion-title",1),e._uU(32,"Prestamos en curso"),e.qZA()(),e.TgZ(33,"div",14),e.YNc(34,S,5,2,"ion-row",15),e.ALo(35,"keyvalue"),e.qZA()()(),e.TgZ(36,"ion-row",16)(37,"ion-col",4)(38,"form",6),e.NdJ("ngSubmit",function(){return n.invertir(n.invertirForm.value)}),e.TgZ(39,"ion-item")(40,"ion-row",17)(41,"ion-col",18)(42,"ion-label",7),e._uU(43,"Invierte wei:"),e.qZA(),e._UZ(44,"ion-input",19),e.qZA(),e.TgZ(45,"ion-col",18)(46,"ion-button",12),e._uU(47,"Invertir"),e.qZA()()()()(),e.TgZ(48,"ion-item",20)(49,"ion-text"),e._uU(50),e.qZA()()(),e.TgZ(51,"ion-col",4)(52,"form",6),e.NdJ("ngSubmit",function(){return n.recogerFondos(n.recogerForm.value)}),e.TgZ(53,"ion-item")(54,"ion-row",17)(55,"ion-col",18)(56,"ion-label",7),e._uU(57,"Recoge wei:"),e.qZA(),e._UZ(58,"ion-input",19),e.qZA(),e.TgZ(59,"ion-col",18)(60,"ion-button",12),e._uU(61,"Recoger Fondos"),e.qZA()()()()(),e.TgZ(62,"ion-button",21),e.NdJ("click",function(){return n.checkeoMensual()}),e._uU(63,"Checkeo mensual"),e.qZA()(),e.TgZ(64,"ion-col",4)(65,"ion-button",22),e.NdJ("click",function(){return n.logOut()}),e._uU(66,"LOG OUT"),e.qZA()()()()),2&t&&(e.Q6J("translucent",!0),e.xp6(3),e.hij("ADMIN: ",n.admin,""),e.xp6(1),e.Q6J("fullscreen",!0),e.xp6(6),e.Q6J("formGroup",n.definirForm),e.xp6(24),e.Q6J("ngForOf",e.lcZ(35,8,n.prestamosCursando)),e.xp6(4),e.Q6J("formGroup",n.invertirForm),e.xp6(12),e.hij(" BALANCE: ",n.balance," "),e.xp6(2),e.Q6J("formGroup",n.recogerForm))},dependencies:[h.sg,m._Y,m.JJ,m.JL,s.YG,s.wI,s.W2,s.Gu,s.pK,s.Ie,s.Q$,s.Nd,s.yW,s.wd,s.sr,s.j9,m.sg,m.u,h.Nd],styles:['@charset "UTF-8";.scrollable-content[_ngcontent-%COMP%]{max-height:300px;overflow-y:auto}']}),u})()}];let U=(()=>{var o;class u{}return(o=u).\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[Z.Bz.forChild(y),Z.Bz]}),u})(),F=(()=>{var o;class u{}return(o=u).\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[h.ez,m.u5,s.Pc,U,m.UX]}),u})()}}]);